<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Parallelized likelihood ratio test for segregation distortion for arbitrary (even) ploidies. — seg_multi • segtest</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parallelized likelihood ratio test for segregation distortion for arbitrary (even) ploidies. — seg_multi"><meta name="description" content="Uses the future package to implement parallelization support for
the likelihood ratio tests for segregation distortion. Details of
this test are provided in the seg_lrt() function's
documentation."><meta property="og:description" content="Uses the future package to implement parallelization support for
the likelihood ratio tests for segregation distortion. Details of
this test are provided in the seg_lrt() function's
documentation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">segtest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/intro_1.html">Introduction to segtest Version 1.0</a></li>
    <li><a class="dropdown-item" href="../articles/intro_2.html">Introduction to segtest Version 2.0</a></li>
    <li><a class="dropdown-item" href="../articles/parallel.html">Parallel Testing</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dcgerard/segtest/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Parallelized likelihood ratio test for segregation distortion for arbitrary (even) ploidies.</h1>
      <small class="dont-index">Source: <a href="https://github.com/dcgerard/segtest/blob/HEAD/R/higher_freq.R" class="external-link"><code>R/higher_freq.R</code></a></small>
      <div class="d-none name"><code>seg_multi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses the future package to implement parallelization support for
the likelihood ratio tests for segregation distortion. Details of
this test are provided in the <code><a href="seg_lrt.html">seg_lrt</a>()</code> function's
documentation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">seg_multi</span><span class="op">(</span></span>
<span>  <span class="va">g</span>,</span>
<span>  <span class="va">p1_ploidy</span>,</span>
<span>  p2_ploidy <span class="op">=</span> <span class="va">p1_ploidy</span>,</span>
<span>  p1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seg"</span>, <span class="st">"auto"</span>, <span class="st">"auto_dr"</span>, <span class="st">"allo"</span>, <span class="st">"allo_pp"</span>, <span class="st">"auto_allo"</span><span class="op">)</span>,</span>
<span>  outlier <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ret_out <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ob <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span>  db <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ces"</span>, <span class="st">"prcs"</span><span class="op">)</span>,</span>
<span>  ntry <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  df_tol <span class="op">=</span> <span class="fl">0.001</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-g">g<a class="anchor" aria-label="anchor" href="#arg-g"></a></dt>
<dd><p>One of two inputs</p><ul><li><p>A matrix of genotype counts. The rows index the loci and the columns index the genotypes.</p></li>
<li><p>An array of genotype log-likelihoods. The rows index the loci, the columns index the individuals, and the slices index the genotypes. Log-likelihoods are base e (natural log).</p></li>
</ul></dd>


<dt id="arg-p-ploidy-p-ploidy">p1_ploidy, p2_ploidy<a class="anchor" aria-label="anchor" href="#arg-p-ploidy-p-ploidy"></a></dt>
<dd><p>The ploidy of the first or second parent. Should be even.</p></dd>


<dt id="arg-p-">p1<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>One of three inputs</p><ul><li><p>A vector of parent 1's genotypes.</p></li>
<li><p>A matrix of parent 1's genotype log-likelihoods. The rows index the loci and the columns index the genotypes. Logs are in base e (natural log).</p></li>
<li><p><code>NULL</code> (only supported when using genotype likelihoods for the offspring)</p></li>
</ul></dd>


<dt id="arg-p-">p2<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>One of three inputs</p><ul><li><p>A vector of parent 1's genotypes.</p></li>
<li><p>A matrix of parent 1's genotype log-likelihoods. The rows index the loci and the columns index the genotypes. Logs are in base e (natural log).</p></li>
<li><p><code>NULL</code> (only supported when using genotype likelihoods for the offspring)</p></li>
</ul></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>One of six forms:</p><dl><dt><code>"seg"</code></dt>
<dd><p>Segmental allopolyploid. Allows for arbitrary levels of polysomic and disomic inheritance. This can account for partial preferential pairing. It also accounts for double reduction at simplex loci.</p></dd>

<dt><code>"auto"</code></dt>
<dd><p>Autopolyploid. Allows only for polysomic inheritance. No double reduction.</p></dd>

<dt><code>"auto_dr"</code></dt>
<dd><p>Autopolyploid, allowing for the effects of double reduction.</p></dd>

<dt><code>"allo"</code></dt>
<dd><p>Allopolyploid. Only complete disomic inheritance is explored.</p></dd>

<dt><code>"allo_pp"</code></dt>
<dd><p>Allopolyploid, allowing for the effects of partial preferential pairing. Though, autopolyploid (with complete bivalent pairing and no double reduction) is a special case of this model.</p></dd>

<dt><code>"auto_allo"</code></dt>
<dd><p>Only complete disomic and complete polysomic inheritance is studied.</p></dd>


</dl></dd>


<dt id="arg-outlier">outlier<a class="anchor" aria-label="anchor" href="#arg-outlier"></a></dt>
<dd><p>A logical. Should we allow for outliers (<code>TRUE</code>) or not (<code>FALSE</code>)?</p></dd>


<dt id="arg-ret-out">ret_out<a class="anchor" aria-label="anchor" href="#arg-ret-out"></a></dt>
<dd><p>A logical. Should we return the probability that each individual is an outlier (<code>TRUE</code>) or not (<code>FALSE</code>)?</p></dd>


<dt id="arg-ob">ob<a class="anchor" aria-label="anchor" href="#arg-ob"></a></dt>
<dd><p>The default upper bound on the outlier proportion.</p></dd>


<dt id="arg-db">db<a class="anchor" aria-label="anchor" href="#arg-db"></a></dt>
<dd><p>Should we use the complete equational segregation model (<code>"ces"</code>) or
the pure random chromatid segregation model (<code>"prcs"</code>) to determine the upper
bound(s) on the double reduction rate(s). See <code><a href="drbounds.html">drbounds</a>()</code>
for details.</p></dd>


<dt id="arg-ntry">ntry<a class="anchor" aria-label="anchor" href="#arg-ntry"></a></dt>
<dd><p>The number of times to try the optimization.
You probably do not want to touch this.</p></dd>


<dt id="arg-df-tol">df_tol<a class="anchor" aria-label="anchor" href="#arg-df-tol"></a></dt>
<dd><p>Threshold for the rank of the Jacobian for the degrees of
freedom calculation. This accounts for underidentifiability in the
null model. You probably do not want to touch this.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with the following elements:</p><dl><dt><code>statistic</code></dt>
<dd><p>The likelihood ratio test statistic</p></dd>

<dt><code>p_value</code></dt>
<dd><p>The p-value of the likelihood ratio test.</p></dd>

<dt><code>df</code></dt>
<dd><p>The (estimated) degrees of freedom of the test.</p></dd>

<dt><code>null_bic</code></dt>
<dd><p>The BIC of the null model (no segregation distortion).</p></dd>

<dt><code>df0</code></dt>
<dd><p>The (estimated) number of parameters under null.</p></dd>

<dt><code>df1</code></dt>
<dd><p>The (estimated) number of parameters under the alternative.</p></dd>

<dt><code>p1</code></dt>
<dd><p>The (estimated) genotype of parent 1.</p></dd>

<dt><code>p2</code></dt>
<dd><p>The (estimated) genotype of parent 2.</p></dd>

<dt><code>q0</code></dt>
<dd><p>The MLE of the genotype frequencies under the null.</p></dd>

<dt><code>q1</code></dt>
<dd><p>The MLE of the genotype frequencies under the alternative.</p></dd>

<dt><code>outprob</code></dt>
<dd><p>Outlier probabilities. Only returned in <code>ret_out = TRUE</code>.</p><ul><li><p>If using genotype counts, element <code>i</code> is the probability that an individual <em>with genotype</em> <code>i-1</code> is an outlier. So the return vector has length ploidy plus 1.</p></li>
<li><p>If using genotype log-likelihoods, element <code>i</code> is the probability that individual <code>i</code> is an outlier. So the return vector has the same length as the number of individuals.</p></li>
</ul><p>These outlier probabilities are only valid if the null of no segregation is true.</p></dd>


</dl><p>Note that since this data frame contains the list-columns <code>q0</code> and
<code>q1</code>, you cannot use <code><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a>()</code> to save it.
You have to either remove those columns first or use something
like <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a>()</code></p>
    </div>
    <div class="section level2">
    <h2 id="parallel-computation">Parallel Computation<a class="anchor" aria-label="anchor" href="#parallel-computation"></a></h2>



<p>The <code>seg_multi()</code> function supports parallel computing. It does
so through the <a href="https://cran.r-project.org/package=future" class="external-link">future</a>
package.</p>
<p>You first specify the evaluation plan with <code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a>()</code>
from the <code>future</code> package. On a local machine, this is typically
just <code>future::plan(future::multisession, workers = nc)</code> where
<code>nc</code> is the number of workers you want. You can find the maximum
number of possible workers with <code><a href="https://parallelly.futureverse.org/reference/availableCores.html" class="external-link">availableCores</a>()</code>.
You then run <code>seg_multi()</code>, then shut down the workers with
<code>future::plan(future::sequential)</code>. The pseudo code is</p><div class="sourceCode"><pre><code><span></span>
<span>  <span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span>, workers <span class="op">=</span> <span class="va">nc</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/seg_multi.html">seg_multi</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/sequential.html" class="external-link">sequential</a></span><span class="op">)</span></span></code></pre></div>

    </div>
    <div class="section level2">
    <h2 id="null-model">Null Model<a class="anchor" aria-label="anchor" href="#null-model"></a></h2>


<p>The gamete frequencies under the null model can be calculated via
<code><a href="gamfreq.html">gamfreq</a>()</code>. The genotype frequencies, which are just
a discrete linear convolution (<code><a href="https://rdrr.io/r/stats/convolve.html" class="external-link">convolve</a>()</code>) of the
gamete frequencies, can be calculated via <code><a href="gf_freq.html">gf_freq</a>()</code>.</p>
<p>The null model's gamete frequencies for true autopolyploids
(<code>model = "auto"</code>) or
true allopolyploids (<code>model = "allo"</code>) are given in the <code><a href="seg.html">seg</a></code> data frame
that comes with this package. I only made that data frame go up to
ploidy 20, but let me know if you need it for higher ploidies.</p>
<p>The polyRAD folks test for full autopolyploid and full allopolyploid, so I
included that as an option (<code>model = "auto_allo"</code>).</p>
<p>We can account for arbitrary levels of double reduction in autopolyploids
(<code>model = "auto_dr"</code>) using the gamete frequencies from
Huang et al (2019).</p>
<p>The null model for segmental allopolyploids (<code>model = "allo_pp"</code>) is the mixture model of
the possible allopolyploid gamete frequencies. The autopolyploid model
(without double reduction) is a subset of this mixture model.</p>
<p>In the above mixture model, we can account for double reduction for simplex
loci (<code>model = "seg"</code>) by just slightly reducing the
number of simplex gametes and increasing the number of duplex and
nullplex gametes. That is, the frequencies for (nullplex, simplex, duplex)
gametes go from <code>(0.5, 0.5, 0)</code> to
<code>(0.5 + b, 0.5 - 2 * b, b)</code>.</p>
<p><code>model = "seg"</code> is the most general, so it is the default. But you
should use other models if you have more information on your species. E.g.
if you know you have an autopolyploid, use either <code>model = "auto"</code>
or <code>model = "auto_dr"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="unidentified-parameters">Unidentified Parameters<a class="anchor" aria-label="anchor" href="#unidentified-parameters"></a></h2>


<p>Do NOT interpret the estimated parameters in the <code>null$gam</code> list.
These parameters are underidentified (I had to do some fancy
spectral methods to account for this in the null distribution
of the tests). Even though they are technically identified, you would
need a massive data set to be able to estimate them accurately.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="seg_lrt.html">seg_lrt()</a></code> Single locus LRT for segregation distortion.</p></li>
<li><p><code><a href="gamfreq.html">gamfreq()</a></code> Gamete frequencies under various models of meiosis</p></li>
<li><p><code><a href="gf_freq.html">gf_freq()</a></code> F1 genotype frequencies under various models of meiosis.</p></li>
<li><p><code><a href="multidog_to_g.html">multidog_to_g()</a></code> Converts the output of <code><a href="https://rdrr.io/pkg/updog/man/multidog.html" class="external-link">updog::multidog()</a></code> into something that you can input into <code>seg_multi()</code>.</p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David Gerard</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Assuming genotypes are known (typically a bad idea)</span></span></span>
<span class="r-in"><span><span class="va">glist</span> <span class="op">&lt;-</span> <span class="fu"><a href="multidog_to_g.html">multidog_to_g</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  mout <span class="op">=</span> <span class="va">ufit</span>,</span></span>
<span class="r-in"><span>  ploidy <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"all_g"</span>,</span></span>
<span class="r-in"><span>  p1 <span class="op">=</span> <span class="st">"indigocrisp"</span>,</span></span>
<span class="r-in"><span>  p2 <span class="op">=</span> <span class="st">"sweetcrisp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1_1</span> <span class="op">&lt;-</span> <span class="va">glist</span><span class="op">$</span><span class="va">p1</span></span></span>
<span class="r-in"><span><span class="va">p2_1</span> <span class="op">&lt;-</span> <span class="va">glist</span><span class="op">$</span><span class="va">p2</span></span></span>
<span class="r-in"><span><span class="va">g_1</span> <span class="op">&lt;-</span> <span class="va">glist</span><span class="op">$</span><span class="va">g</span></span></span>
<span class="r-in"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu">seg_multi</span><span class="op">(</span></span></span>
<span class="r-in"><span>  g <span class="op">=</span> <span class="va">g_1</span>,</span></span>
<span class="r-in"><span>  p1_ploidy <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  p2_ploidy <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  p1 <span class="op">=</span> <span class="va">p1_1</span>,</span></span>
<span class="r-in"><span>  p2 <span class="op">=</span> <span class="va">p2_1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s1</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"snp"</span>, <span class="st">"p_value"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            snp     p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1_44673475 0.205984263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  11_28836119 0.196442803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  12_31029646 0.008922285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   12_8487773 0.995196014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    2_1426329 0.616648977</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   2_20070837 0.160147847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   2_40108108 0.386228653</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   4_37820371 0.157706919</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   6_30619745 0.605526292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   6_4350249 0.674843558</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Put NULL if you have absolutely no information on the parents</span></span></span>
<span class="r-in"><span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu">seg_multi</span><span class="op">(</span>g <span class="op">=</span> <span class="va">g_1</span>, p1_ploidy <span class="op">=</span> <span class="fl">4</span>, p2_ploidy <span class="op">=</span> <span class="fl">4</span>, p1 <span class="op">=</span> <span class="cn">NULL</span>, p2 <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s2</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"snp"</span>, <span class="st">"p_value"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            snp     p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1_44673475 0.205984263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  11_28836119 0.196442803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  12_31029646 0.008922285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   12_8487773 0.995196014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    2_1426329 0.616648977</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   2_20070837 0.160147847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   2_40108108 0.386228653</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   4_37820371 0.157706919</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   6_30619745 0.605526292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   6_4350249 0.674843558</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Using genotype likelihoods (typically a good idea)</span></span></span>
<span class="r-in"><span><span class="co">## Also demonstrate parallelization through future package.</span></span></span>
<span class="r-in"><span><span class="va">glist</span> <span class="op">&lt;-</span> <span class="fu"><a href="multidog_to_g.html">multidog_to_g</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  mout <span class="op">=</span> <span class="va">ufit</span>,</span></span>
<span class="r-in"><span>  ploidy <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"all_gl"</span>,</span></span>
<span class="r-in"><span>  p1 <span class="op">=</span> <span class="st">"indigocrisp"</span>,</span></span>
<span class="r-in"><span>  p2 <span class="op">=</span> <span class="st">"sweetcrisp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1_2</span> <span class="op">&lt;-</span> <span class="va">glist</span><span class="op">$</span><span class="va">p1</span></span></span>
<span class="r-in"><span><span class="va">p2_2</span> <span class="op">&lt;-</span> <span class="va">glist</span><span class="op">$</span><span class="va">p2</span></span></span>
<span class="r-in"><span><span class="va">g_2</span> <span class="op">&lt;-</span> <span class="va">glist</span><span class="op">$</span><span class="va">g</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span>, workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s3</span> <span class="op">&lt;-</span> <span class="fu">seg_multi</span><span class="op">(</span>g <span class="op">=</span> <span class="va">g_2</span>, p1_ploidy <span class="op">=</span> <span class="fl">4</span>, p2_ploidy <span class="op">=</span> <span class="fl">4</span>, p1 <span class="op">=</span> <span class="va">p1_2</span>, p2 <span class="op">=</span> <span class="va">p2_2</span>, ret_out <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: foreach</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: rngtools</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: foreach</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: rngtools</span>
<span class="r-in"><span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/sequential.html" class="external-link">sequential</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s3</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"snp"</span>, <span class="st">"p_value"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            snp    p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1_44673475 0.20525001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  11_28836119 0.20013872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  12_31029646 0.01800832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   12_8487773 0.99521289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    2_1426329 0.45701691</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   2_20070837 0.13228993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   2_40108108 0.26596888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   4_37820371 0.21251272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   6_30619745 0.61700707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   6_4350249 0.64950122</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Outlier probabilities are returned if `ret_out = TRUE`</span></span></span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s3</span><span class="op">$</span><span class="va">outprob</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="seg_multi-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Gerard, Mira Thakkar, NSF DBI 2132247.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

