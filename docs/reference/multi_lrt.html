<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Parallelized likelihood ratio test for segregation distortion. — multi_lrt • segtest</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parallelized likelihood ratio test for segregation distortion. — multi_lrt"><meta name="description" content='Uses the future package to implement parallelization support for
the likelihood ratio tests for segregation distortion. Right now, this is
only supported for tetraploids (allo, auto, or segmental). This function
is only somewhat tested (the single-locus LRT functions in the "See Also"
section are very well tested). So please send any bugs you notice to
https://github.com/dcgerard/segtest/issues.'><meta property="og:description" content='Uses the future package to implement parallelization support for
the likelihood ratio tests for segregation distortion. Right now, this is
only supported for tetraploids (allo, auto, or segmental). This function
is only somewhat tested (the single-locus LRT functions in the "See Also"
section are very well tested). So please send any bugs you notice to
https://github.com/dcgerard/segtest/issues.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">segtest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/intro.html">Introduction to segtest</a></li>
    <li><a class="dropdown-item" href="../articles/parallel.html">Parallel Testing</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dcgerard/segtest/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Parallelized likelihood ratio test for segregation distortion.</h1>
      <small class="dont-index">Source: <a href="https://github.com/dcgerard/segtest/blob/HEAD/R/multi.R" class="external-link"><code>R/multi.R</code></a></small>
      <div class="d-none name"><code>multi_lrt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses the <code>future</code> package to implement parallelization support for
the likelihood ratio tests for segregation distortion. Right now, this is
only supported for tetraploids (allo, auto, or segmental). This function
is only somewhat tested (the single-locus LRT functions in the "See Also"
section are very well tested). So please send any bugs you notice to
<a href="https://github.com/dcgerard/segtest/issues" class="external-link">https://github.com/dcgerard/segtest/issues</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">multi_lrt</span><span class="op">(</span></span>
<span>  <span class="va">g</span>,</span>
<span>  <span class="va">p1</span>,</span>
<span>  <span class="va">p2</span>,</span>
<span>  drbound <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>,</span>
<span>  pp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  xi1 <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  xi2 <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  nullprop <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-g">g<a class="anchor" aria-label="anchor" href="#arg-g"></a></dt>
<dd><p>One of two inputs</p><ul><li><p>A matrix of genotype counts. The rows index the loci and the columns index the genotypes.</p></li>
<li><p>An array of genotype log-likelihoods. The rows index the loci, the columns index the individuals, and the slices index the genotypes. Log-likelihoods are base e (natural log).</p></li>
</ul></dd>


<dt id="arg-p-">p1<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>One of three inputs</p><ul><li><p>A vector of parent 1's genotypes.</p></li>
<li><p>A matrix of parent 1's genotype log-likelihoods. The rows index the loci and the columns index the genotypes. Logs are in base e (natural log).</p></li>
<li><p><code>NULL</code> (only supported when using genotype likelihoods for the offspring)</p></li>
</ul></dd>


<dt id="arg-p-">p2<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>One of three inputs</p><ul><li><p>A vector of parent 1's genotypes.</p></li>
<li><p>A matrix of parent 1's genotype log-likelihoods. The rows index the loci and the columns index the genotypes. Logs are in base e (natural log).</p></li>
<li><p><code>NULL</code> (only supported when using genotype likelihoods for the offspring)</p></li>
</ul></dd>


<dt id="arg-drbound">drbound<a class="anchor" aria-label="anchor" href="#arg-drbound"></a></dt>
<dd><p>The upper bound on the double reduction rate.</p></dd>


<dt id="arg-pp">pp<a class="anchor" aria-label="anchor" href="#arg-pp"></a></dt>
<dd><p>Is (partial) preferential pairing possible (<code>TRUE</code>) or
not (<code>FALSE</code>)?</p></dd>


<dt id="arg-dr">dr<a class="anchor" aria-label="anchor" href="#arg-dr"></a></dt>
<dd><p>Is double reduction possible (<code>TRUE</code>) or
not (<code>FALSE</code>)?</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>If <code>dr = FALSE</code>, this is the known rate of double
reduction.</p></dd>


<dt id="arg-xi-">xi1<a class="anchor" aria-label="anchor" href="#arg-xi-"></a></dt>
<dd><p>If <code>pp = FALSE</code>, this is the known preferential pairing
parameter of parent 1.</p></dd>


<dt id="arg-xi-">xi2<a class="anchor" aria-label="anchor" href="#arg-xi-"></a></dt>
<dd><p>If <code>pp = FALSE</code>, this is the known preferential pairing
parameter of parent 2.</p></dd>


<dt id="arg-nullprop">nullprop<a class="anchor" aria-label="anchor" href="#arg-nullprop"></a></dt>
<dd><p>Should we return the null proportions (<code>TRUE</code>) or not (<code>FALSE</code>)?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="parallel-computation">Parallel Computation<a class="anchor" aria-label="anchor" href="#parallel-computation"></a></h2>



<p>The <code>multi_lrt()</code> function supports parallel computing. It does
so through the <a href="https://cran.r-project.org/package=future" class="external-link">future</a>
package.</p>
<p>You first specify the evaluation plan with <code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a>()</code>
from the <code>future</code> package. On a local machine, this is typically
just <code>future::plan(future::multisession, workers = nc)</code> where
<code>nc</code> is the number of workers you want. You can find the maximum
number of possible workers with <code><a href="https://parallelly.futureverse.org/reference/availableCores.html" class="external-link">availableCores</a>()</code>.
You then run <code>multi_lrt()</code>, then shut down the workers with
<code>future::plan(future::sequential)</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="lrt_men_g4.html">lrt_men_g4()</a></code> Single locus LRT for segregation distortion when genotypes are known.</p></li>
<li><p><code><a href="lrt_men_gl4.html">lrt_men_gl4()</a></code> Single locus LRT for segregation distortion when using genotype likelihoods.</p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David Gerard</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## Assuming genotypes are known (typically a bad idea)</span></span></span>
<span class="r-in"><span><span class="va">glist</span> <span class="op">&lt;-</span> <span class="fu"><a href="multidog_to_g.html">multidog_to_g</a></span><span class="op">(</span>mout <span class="op">=</span> <span class="va">ufit</span>, type <span class="op">=</span> <span class="st">"all_g"</span>, p1 <span class="op">=</span> <span class="st">"indigocrisp"</span>, p2 <span class="op">=</span> <span class="st">"sweetcrisp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1_1</span> <span class="op">&lt;-</span> <span class="va">glist</span><span class="op">$</span><span class="va">p1</span></span></span>
<span class="r-in"><span><span class="va">p2_1</span> <span class="op">&lt;-</span> <span class="va">glist</span><span class="op">$</span><span class="va">p2</span></span></span>
<span class="r-in"><span><span class="va">g_1</span> <span class="op">&lt;-</span> <span class="va">glist</span><span class="op">$</span><span class="va">g</span></span></span>
<span class="r-in"><span><span class="fu">multi_lrt</span><span class="op">(</span>g <span class="op">=</span> <span class="va">g_1</span>, p1 <span class="op">=</span> <span class="va">p1_1</span>, p2 <span class="op">=</span> <span class="va">p2_1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Using genotype likelihoods (typically a good idea)</span></span></span>
<span class="r-in"><span><span class="va">glist</span> <span class="op">&lt;-</span> <span class="fu"><a href="multidog_to_g.html">multidog_to_g</a></span><span class="op">(</span>mout <span class="op">=</span> <span class="va">ufit</span>, type <span class="op">=</span> <span class="st">"all_gl"</span>, p1 <span class="op">=</span> <span class="st">"indigocrisp"</span>, p2 <span class="op">=</span> <span class="st">"sweetcrisp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1_2</span> <span class="op">&lt;-</span> <span class="va">glist</span><span class="op">$</span><span class="va">p1</span></span></span>
<span class="r-in"><span><span class="va">p2_2</span> <span class="op">&lt;-</span> <span class="va">glist</span><span class="op">$</span><span class="va">p2</span></span></span>
<span class="r-in"><span><span class="va">g_2</span> <span class="op">&lt;-</span> <span class="va">glist</span><span class="op">$</span><span class="va">g</span></span></span>
<span class="r-in"><span><span class="fu">multi_lrt</span><span class="op">(</span>g <span class="op">=</span> <span class="va">g_2</span>, p1 <span class="op">=</span> <span class="va">p1_2</span>, p2 <span class="op">=</span> <span class="va">p2_2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Offspring genotype likelihoods and parent genotypes known</span></span></span>
<span class="r-in"><span><span class="fu">multi_lrt</span><span class="op">(</span>g <span class="op">=</span> <span class="va">g_2</span>, p1 <span class="op">=</span> <span class="va">p1_1</span>, p2 <span class="op">=</span> <span class="va">p2_1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Offspring genotype likelihoods and no information on parent genotypes</span></span></span>
<span class="r-in"><span><span class="fu">multi_lrt</span><span class="op">(</span>g <span class="op">=</span> <span class="va">g_2</span>, p1 <span class="op">=</span> <span class="cn">NULL</span>, p2 <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Parallel computing is supported through the future package</span></span></span>
<span class="r-in"><span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span>, workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">multi_lrt</span><span class="op">(</span>g <span class="op">=</span> <span class="va">g_2</span>, p1 <span class="op">=</span> <span class="va">p1_2</span>, p2 <span class="op">=</span> <span class="va">p2_2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/sequential.html" class="external-link">sequential</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Gerard, Mira Thakkar, NSF DBI 2132247.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

