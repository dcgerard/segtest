<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Parallel Testing • segtest</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parallel Testing">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">segtest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/intro_1.html">Introduction to segtest Version 1.0</a></li>
    <li><a class="dropdown-item" href="../articles/intro_2.html">Introduction to segtest Version 2.0</a></li>
    <li><a class="dropdown-item" href="../articles/parallel.html">Parallel Testing</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dcgerard/segtest/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Parallel Testing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dcgerard/segtest/blob/HEAD/vignettes/parallel.Rmd" class="external-link"><code>vignettes/parallel.Rmd</code></a></small>
      <div class="d-none name"><code>parallel.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dcgerard.github.io/segtest/">segtest</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>We provide a walk-through of how to run tests for segregation
distortion at many loci in parallel. Details of the methods may be found
in Gerard et al. (2025a) and Gerard et al. (2025b).</p>
</div>
<div class="section level2">
<h2 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h2>
<p>Data sets <code>ufit</code>, <code>ufit2</code>, and
<code>ufit3</code> contain the genotyping output of
<code><a href="https://rdrr.io/pkg/updog/man/multidog.html" class="external-link">updog::multidog()</a></code> using three different models.</p>
<ul>
<li>
<code>ufit</code>: Uses the <code>norm</code> model without
specifying who the parents are.</li>
<li>
<code>ufit2</code>: Uses the <code>f1pp</code> model, specifying the
parents.</li>
<li>
<code>ufit3</code>: Uses the <code>f1</code> model, specifying the
parents.</li>
</ul>
<p>You can convert this genotyping output to what
<code><a href="../reference/seg_multi.html">seg_multi()</a></code> expects using <code><a href="../reference/multidog_to_g.html">multidog_to_g()</a></code>.</p>
<p>If you did <em>not</em> use the <code>f1pp</code> or <code>f1</code>
models, use ether the <code>all_gl</code> (to run tests using genotype
log-likelihoods) or <code>all_g</code> (to run tests assuming genotypes
are known) options, and you must specify the ID’s of the parents.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multidog_to_g.html">multidog_to_g</a></span><span class="op">(</span><span class="va">ufit</span>, ploidy <span class="op">=</span> <span class="fl">4</span>, type <span class="op">=</span> <span class="st">"all_g"</span>, p1 <span class="op">=</span> <span class="st">"indigocrisp"</span>, p2 <span class="op">=</span> <span class="st">"sweetcrisp"</span><span class="op">)</span></span>
<span><span class="va">o2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multidog_to_g.html">multidog_to_g</a></span><span class="op">(</span><span class="va">ufit</span>, ploidy <span class="op">=</span> <span class="fl">4</span>, type <span class="op">=</span> <span class="st">"all_gl"</span>, p1 <span class="op">=</span> <span class="st">"indigocrisp"</span>, p2 <span class="op">=</span> <span class="st">"sweetcrisp"</span><span class="op">)</span></span></code></pre></div>
<p>If you <em>did</em> use the <code>f1pp</code> or <code>f1</code>
models, use either the <code>off_gl</code> (to run tests using genotype
log-likelihoods) or <code>off_g</code> (to run tests assuming genotypes
are known) options.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multidog_to_g.html">multidog_to_g</a></span><span class="op">(</span><span class="va">ufit2</span>, ploidy <span class="op">=</span> <span class="fl">4</span>, type <span class="op">=</span> <span class="st">"off_g"</span><span class="op">)</span></span>
<span><span class="va">o4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multidog_to_g.html">multidog_to_g</a></span><span class="op">(</span><span class="va">ufit2</span>, ploidy <span class="op">=</span> <span class="fl">4</span>, type <span class="op">=</span> <span class="st">"off_gl"</span><span class="op">)</span></span>
<span><span class="va">o5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multidog_to_g.html">multidog_to_g</a></span><span class="op">(</span><span class="va">ufit3</span>, ploidy <span class="op">=</span> <span class="fl">4</span>, type <span class="op">=</span> <span class="st">"off_g"</span><span class="op">)</span></span>
<span><span class="va">o6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multidog_to_g.html">multidog_to_g</a></span><span class="op">(</span><span class="va">ufit3</span>, ploidy <span class="op">=</span> <span class="fl">4</span>, type <span class="op">=</span> <span class="st">"off_gl"</span><span class="op">)</span></span></code></pre></div>
<p>We would recommend <em>always</em> using genotype log-likelihoods.
But the option is there for known genotypes.</p>
<p>Parallelization support is provided through the future package. You
specify how to implement parallelization using
<code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">future::plan()</a></code>. Then you run <code><a href="../reference/seg_multi.html">seg_multi()</a></code>. Then
you shut down the parallelization with <code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">future::plan()</a></code>. The
most common plan is <code><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">future::multisession()</a></code>, where you
specify the number of parallel processes with the <code>workers</code>
argument. You can get the maximum number of workers via
<code><a href="https://parallelly.futureverse.org/reference/availableCores.html" class="external-link">future::availableCores()</a></code></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableCores.html" class="external-link">availableCores</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; system </span></span>
<span><span class="co">#&gt;     16</span></span></code></pre></div>
<p>So a typically workload looks something like this:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span><span class="op">(</span>workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mout1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seg_multi.html">seg_multi</a></span><span class="op">(</span></span>
<span>  g <span class="op">=</span> <span class="va">o2</span><span class="op">$</span><span class="va">g</span>, </span>
<span>  p1 <span class="op">=</span> <span class="va">o2</span><span class="op">$</span><span class="va">p1</span>,</span>
<span>  p2 <span class="op">=</span> <span class="va">o2</span><span class="op">$</span><span class="va">p2</span>, </span>
<span>  p1_ploidy <span class="op">=</span> <span class="fl">4</span>, </span>
<span>  p2_ploidy <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  ret_out <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/sequential.html" class="external-link">sequential</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Loading required package: foreach</span></span>
<span><span class="co">#&gt; Loading required package: rngtools</span></span></code></pre>
<p>The output is a data frame. The most important parts of this are the
<code>snp</code> and <code>p_value</code> columns.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mout1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"snp"</span>, <span class="st">"p_value"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;            snp    p_value</span></span>
<span><span class="co">#&gt; 1   1_44673475 0.20525001</span></span>
<span><span class="co">#&gt; 2  11_28836119 0.20013872</span></span>
<span><span class="co">#&gt; 3  12_31029646 0.01800832</span></span>
<span><span class="co">#&gt; 4   12_8487773 0.99521289</span></span>
<span><span class="co">#&gt; 5    2_1426329 0.45701691</span></span>
<span><span class="co">#&gt; 6   2_20070837 0.13228993</span></span>
<span><span class="co">#&gt; 7   2_40108108 0.26596888</span></span>
<span><span class="co">#&gt; 8   4_37820371 0.21251272</span></span>
<span><span class="co">#&gt; 9   6_30619745 0.61700707</span></span>
<span><span class="co">#&gt; 10   6_4350249 0.64950122</span></span></code></pre></div>
<p>It looks like only SNP <code>12_31029646</code> is in possible
segregation distortion. Let’s compare the expected frequencies (from the
<code>q0</code> column) against the observed modes.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mout1</span><span class="op">$</span><span class="va">q0</span><span class="op">[</span><span class="va">mout1</span><span class="op">$</span><span class="va">snp</span> <span class="op">==</span> <span class="st">"12_31029646"</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2008 0.5985 0.2008 0.0000 0.0000</span></span>
<span><span class="va">o1</span><span class="op">$</span><span class="va">g</span><span class="op">[</span><span class="st">"12_31029646"</span>, <span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">o1</span><span class="op">$</span><span class="va">g</span><span class="op">[</span><span class="st">"12_31029646"</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;         0         1         2         3         4 </span></span>
<span><span class="co">#&gt; 0.1541667 0.5833333 0.2625000 0.0000000 0.0000000</span></span></code></pre></div>
<p>So SNP <code>12_31029646</code> likely got flagged because there are
too many individuals with a genotype of 2, and not enough with a
genotype of 0.</p>
<p>If we would have run <code>outlier = FALSE</code>, then SNP
<code>2_20070837</code> would also have been flagged for possible
segregation distortion</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span><span class="op">(</span>workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mout2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seg_multi.html">seg_multi</a></span><span class="op">(</span></span>
<span>  g <span class="op">=</span> <span class="va">o2</span><span class="op">$</span><span class="va">g</span>,</span>
<span>  p1 <span class="op">=</span> <span class="va">o2</span><span class="op">$</span><span class="va">p1</span>, </span>
<span>  p2 <span class="op">=</span> <span class="va">o2</span><span class="op">$</span><span class="va">p2</span>, </span>
<span>  p1_ploidy <span class="op">=</span> <span class="fl">4</span>, </span>
<span>  p2_ploidy <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  outlier <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/sequential.html" class="external-link">sequential</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mout2</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"snp"</span>, <span class="st">"p_value"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;            snp     p_value</span></span>
<span><span class="co">#&gt; 1   1_44673475 0.205250155</span></span>
<span><span class="co">#&gt; 2  11_28836119 0.200138927</span></span>
<span><span class="co">#&gt; 3  12_31029646 0.018008343</span></span>
<span><span class="co">#&gt; 4   12_8487773 0.995749454</span></span>
<span><span class="co">#&gt; 5    2_1426329 0.457017169</span></span>
<span><span class="co">#&gt; 6   2_20070837 0.001131654</span></span>
<span><span class="co">#&gt; 7   2_40108108 0.265969050</span></span>
<span><span class="co">#&gt; 8   4_37820371 0.212513126</span></span>
<span><span class="co">#&gt; 9   6_30619745 0.617007947</span></span>
<span><span class="co">#&gt; 10   6_4350249 0.649501842</span></span></code></pre></div>
<p>Let’s look at the posterior mode genotypes of SNP
<code>2_20070837</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o1</span><span class="op">$</span><span class="va">g</span><span class="op">[</span><span class="st">"2_20070837"</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;   0   1   2   3   4 </span></span>
<span><span class="co">#&gt;  40 166  32   2   0</span></span>
<span><span class="va">o1</span><span class="op">$</span><span class="va">p1</span><span class="op">[</span><span class="st">"2_20070837"</span><span class="op">]</span></span>
<span><span class="co">#&gt; 2_20070837 </span></span>
<span><span class="co">#&gt;          0</span></span>
<span><span class="va">o1</span><span class="op">$</span><span class="va">p2</span><span class="op">[</span><span class="st">"2_20070837"</span><span class="op">]</span></span>
<span><span class="co">#&gt; 2_20070837 </span></span>
<span><span class="co">#&gt;          2</span></span></code></pre></div>
<p>So SNP <code>2_20070837</code> likely got flagged because of two
individuals that are very likely a genotype of 3, which is impossible if
the parents have genotypes 0 and 2. Including
<code>outlier = TRUE</code> previously made it so that we would ignore
this discrepancy (up to a point). You can get the posterior probability
that an individual is an outlier if you set <code>ret_out = TRUE</code>
(which I previously did).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">mout1</span><span class="op">$</span><span class="va">outprob</span><span class="op">[</span><span class="va">mout1</span><span class="op">$</span><span class="va">snp</span> <span class="op">==</span> <span class="st">"2_20070837"</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, </span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Outlier Probability"</span><span class="op">)</span></span></code></pre></div>
<p><img src="parallel_files/figure-html/unnamed-chunk-13-1.png" alt="Scatterplot of SNP index (x-axis) by outlier probability (y-axis)." width="700"></p>
</div>
<div class="section level2">
<h2 id="multi_lrt">
<code>multi_lrt()</code><a class="anchor" aria-label="anchor" href="#multi_lrt"></a>
</h2>
<p>The older function <code><a href="../reference/multi_lrt.html">multi_lrt()</a></code>, only provides support
for tetraploids. You can still use it instead of
<code><a href="../reference/seg_multi.html">seg_multi()</a></code> for tetraploids.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span><span class="op">(</span>workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mout3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multi_lrt.html">multi_lrt</a></span><span class="op">(</span></span>
<span>  g <span class="op">=</span> <span class="va">o2</span><span class="op">$</span><span class="va">g</span>,</span>
<span>  p1 <span class="op">=</span> <span class="va">o2</span><span class="op">$</span><span class="va">p1</span>, </span>
<span>  p2 <span class="op">=</span> <span class="va">o2</span><span class="op">$</span><span class="va">p2</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/sequential.html" class="external-link">sequential</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>It’s a little faster, but it cannot account for outliers, so it will
mostly be the same as setting <code>outlier = FALSE</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">mout2</span><span class="op">$</span><span class="va">p_value</span>,</span>
<span>  <span class="va">mout3</span><span class="op">$</span><span class="va">p_value</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"seg_multi(outlier = FALSE)"</span>, </span>
<span>  ylab <span class="op">=</span> <span class="st">"multi_lrt()"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="parallel_files/figure-html/unnamed-chunk-16-1.png" alt="Scatterplot of p-values from seg_lrt() (x-axis) by multi_lrt() (y-axis)." width="700"></p>
<p>The one discrepancy above is caused by the new way we calculate the
degrees of freedom:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">mout2</span><span class="op">$</span><span class="va">p_value</span> <span class="op">-</span> <span class="va">mout3</span><span class="op">$</span><span class="va">p_value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mout2</span><span class="op">$</span><span class="va">df</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="va">mout3</span><span class="op">$</span><span class="va">df</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p>The two approaches should give almost equivalent results most of the
time, but the new way is a little better.</p>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Gerard D, Thakkar M, &amp; Ferrão LFV (2025a). “Tests for segregation
distortion in tetraploid F1 populations.” <em>Theoretical and Applied
Genetics</em>, <em>138</em>(30), p. 1–13. <a href="https://doi.org/10.1007/s00122-025-04816-z" class="external-link">doi:10.1007/s00122-025-04816-z</a>.</p>
<p>Gerard, D, Ambrosano, GB, Pereira, GdS, &amp; Garcia, AAF (2025b).
“Tests for segregation distortion in higher ploidy F1 populations.”
<em>bioRxiv</em>, p. 1–20. <a href="https://doi.org/10.1101/2025.06.23.661114" class="external-link">bioRxiv:2025.06.23.661114</a></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Gerard, Mira Thakkar, NSF DBI 2132247.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
